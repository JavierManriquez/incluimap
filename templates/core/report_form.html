{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/reportar.css' %}">
{% endblock %}

{% block content %}

<div class="report-header">
  <h1 class="report-title">
    {% if is_edit %}Editar reporte{% else %}Reportar accesibilidad{% endif %}
  </h1>
 

  <div class="report-badges">
    <span class="badge">‚≠ê 1‚Äì5 estrellas</span>
    <span class="badge">üè∑Ô∏è Etiquetas</span>
    <span class="badge">üì∑ Foto opcional</span>
    {% if is_edit %}
      <span class="badge badge-edit">‚úèÔ∏è Modo edici√≥n</span>
    {% endif %}
  </div>
</div>

<div class="report-container">

  
  <div class="report-form-card">
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      {% if form.non_field_errors %}
        <div class="form-error">{{ form.non_field_errors|striptags }}</div>
      {% endif %}

      
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">üìç</div>
          <div>
            <h3>1. Lugar del reporte</h3>
            <p class="section-desc">Selecciona el sitio donde hiciste la observaci√≥n.</p>
          </div>
        </div>

        <label for="{{ form.place.id_for_label }}">Lugar *</label>
        {{ form.place }}
        {% if form.place.errors %}
          <div class="form-error">{{ form.place.errors|striptags }}</div>
        {% endif %}
      </div>

      
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">üìù</div>
          <div>
            <h3>2. Descripci√≥n</h3>
            <p class="section-desc">Explica brevemente qu√© encontraste.</p>
          </div>
        </div>

        <label for="{{ form.description.id_for_label }}">Detalle del reporte</label>
        {{ form.description }}
      
        {% if form.description.errors %}
          <div class="form-error">{{ form.description.errors|striptags }}</div>
        {% endif %}
      </div>

      
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">‚≠ê</div>
          <div>
            <h3>3. Evaluaci√≥n y etiquetas</h3>
            <p class="section-desc">Indica qu√© tan accesible es y qu√© elementos hay.</p>
          </div>
        </div>

        <div class="two-columns">
          <div>
            <label for="{{ form.rating.id_for_label }}">Evaluaci√≥n</label>
            {{ form.rating }}
            <p class="field-hint">1 = baja accesibilidad ‚Ä¢ 5 = excelente.</p>
            {% if form.rating.errors %}
              <div class="form-error">{{ form.rating.errors|striptags }}</div>
            {% endif %}
          </div>

          <div>
            <label>Etiquetas</label>
            <div class="tags-box">
              {{ form.tags }}
            </div>
            <p class="field-hint">Selecciona las que correspondan.</p>

            {% if form.tags.errors %}
              <div class="form-error">{{ form.tags.errors|striptags }}</div>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- 4. FOTO -->
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">üì∑</div>
          <div>
            <h3>4. Foto del lugar (opcional)</h3>
            <p class="section-desc">Una imagen ayuda a otros usuarios.</p>
          </div>
        </div>

        <div class="upload-wrapper">
          <label class="upload-btn" for="{{ form.photo.id_for_label }}">
            <span class="upload-icon">üì§</span>
            <span>Subir imagen</span>
          </label>
          {{ form.photo }}
        </div>

        <p class="field-hint">Formatos: JPG, PNG, WEBP (m√°x. 5MB)</p>

        {% if report and report.photo %}
        <div class="current-photo">
          <p class="field-hint">Foto actual:</p>
          <img src="{{ report.photo.url }}" class="current-photo-img" alt="Foto actual del reporte">
        </div>
        {% endif %}

        {% if form.photo.errors %}
          <div class="form-error">{{ form.photo.errors|striptags }}</div>
        {% endif %}
      </div>

      
      <div class="form-actions">
        <button type="submit" class="btn-primary">
          {% if is_edit %}Guardar cambios{% else %}Publicar reporte{% endif %}
        </button>

        <a class="btn-secondary" href="{% url 'my_reports' %}">Cancelar</a>
      </div>
    </form>
  </div>

  
  <aside class="report-sidebar">
    <h3>üí° Tips r√°pidos</h3>

    <ul class="tips-list">
      <li>üìç Indica referencias cercanas (cruce, local, estaci√≥n).</li>
      <li>üöß Describe rampas, escaleras, desniveles u obst√°culos.</li>
      <li>‚ö†Ô∏è Se√±ala riesgos importantes (ca√≠das, acceso bloqueado).</li>
      <li>‚ú® Destaca lugares bien adaptados y accesibles.</li>
    </ul>

    <div class="sidebar-footer">
      <span class="sidebar-badge">Comunidad IncluiMap</span>
      <p>Cada reporte mejora la accesibilidad en Maip√∫. ¬°Gracias por aportar!</p>
    </div>
  </aside>

</div>

{% endblock %}

